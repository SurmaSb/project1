pipeline {
    agent any

       stages {
                stage('Build') {
                    steps {
                        dir('react\\my-app') {
                            echo 'Start building process...'
                            bat 'npm install'
                        }
                    }
                }
                stage('Test') {
                    steps {
                        echo 'Testing.. //TODO run automation tests...'
                    }
                }
                stage('Deploy') {
                     steps {
                        echo 'Deployment steps.. //TODO copy build file to target folder...'
                    }
                }
            }
    stage('Deliver') { 
            steps {
               sh 'set -x'
                sh 'nohup npm start > log.txt&'
                sh 'sleep 1'
                sh 'echo $! > .pidfile'
                sh 'set +x'
            }
        }

            post { 
                success {  
                    dir('react\\my-app') {
                            bat 'npm start'
                        }
                }
            }
        }
   

